# Primitive Database Project

Консольное приложение, имитирующее работу системы управления базами данных (СУБД).
Проект разработан на Python с использованием процедурного подхода и современной архитектуры (MVC).
Поддерживает управление таблицами, CRUD-операции, типизацию данных, а также продвинутые механики: кэширование, логирование и безопасную обработку ошибок.

---

## Демонстрация работы

[![asciicast](https://asciinema.org/a/4l5jClhtxXhQcEby.svg)](https://asciinema.org/a/4l5jClhtxXhQcEby)
---

## Установка и запуск

Проект использует **Poetry** для управления зависимостями и **Makefile** для автоматизации команд.

### Требования
* Python 3.10+
* Poetry

### Установка
Клонируйте репозиторий и выполните установку зависимостей:

```bash
git clone https://github.com/dorozhkinivan/project2_Dorozhkin_Ivan_M25-555.git
cd project2_Dorozhkin_Ivan_M25-555

make install
```

### Запуск
Для запуска базы данных используйте команду:

```bash
make project
# Или вручную: poetry run project
```

---

## Функциональность

### Типы данных
Поддерживаются следующие типы данных:
* `int` (целые числа)
* `str` (строки)
* `bool` (булевы значения: true/false)

### Команды управления таблицами

* **Создать таблицу**
  `create_table <имя> <кол:тип> ...`
  *Пример:* `create_table users name:str age:int is_active:bool`
  *(Столбец ID создается автоматически)*

* **Список таблиц**
  `list_tables`

* **Информация о таблице**
  `info <имя>`

* **Удалить таблицу**
  `drop_table <имя>`
  *(Требует подтверждения действия)*

### CRUD Операции (Данные)

* **Добавить запись (Create)**
  `insert into <имя> values (<знач1>, <знач2>, ...)`
  *Пример:* `insert into users values ("Alice", 25, true)`
  *(Выводит время выполнения операции)*

* **Получить записи (Read)**
  *Все:* `select from <имя>`
  *С фильтром:* `select from <имя> where <кол> = <знач>`
  *Пример:* `select from users where age = 25`
  *(Поддерживает кэширование повторных запросов)*

* **Обновить запись (Update)**
  `update <имя> set <кол>=<знач> where <кол>=<знач>`
  *Пример:* `update users set age = 26 where name = "Alice"`

* **Удалить запись (Delete)**
  `delete from <имя> where <кол>=<знач>`
  *(Требует подтверждения действия)*

---

## Структура проекта

Архитектура приложения разделена на слои для удобства поддержки и расширения:

* **src/primitive_db/**
  * `main.py` — Точка входа в приложение.
  * `engine.py` — "Представление" (View). Отвечает за цикл работы, обработку ввода пользователя и вызов контроллеров.
  * `core.py` — "Контроллер" (Controller). Содержит бизнес-логику работы с таблицами и данными.
  * `utils.py` — Слой работы с данными (Model). Отвечает за чтение и запись JSON-файлов.
  * `parser.py` — Модуль для парсинга сложных SQL-подобных команд (WHERE, SET, VALUES).
  * `decorators.py` — Реализация паттернов декораторов (логирование, обработка ошибок, подтверждение действий, кэширование).
  * `constants.py` — Хранение констант проекта.

---

## Используемые технологии

* **Управление зависимостями:** Poetry
* **Линтинг и качество кода:** Ruff (PEP8)
* **Автоматизация:** Makefile
* **Контроль версий:** Git (Github Flow)
* **Библиотеки:**
  * `prettytable` — для красивого вывода таблиц.
  * `prompt` — для удобного ввода команд.

## Автор

**Иван Дорожкин**